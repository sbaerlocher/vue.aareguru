---
name: Security Scanning

on:
  push:
    branches: [main, master]
  pull_request:
    branches: [main, master]
  schedule:
    - cron: "0 2 * * 1" # Weekly Monday 02:00 UTC
  workflow_dispatch:

permissions:
  actions: read
  contents: read
  security-events: write
  pull-requests: write

jobs:
  code-analysis:
    name: SAST (CodeQL)
    uses: sbaerlocher/.github/.github/workflows/security-code.yml@2026-02-19
    with:
      languages: '["javascript-typescript"]'
      node-version-file: ".nvmrc"

  dependency-scan:
    name: Dependencies & Licenses
    uses: sbaerlocher/.github/.github/workflows/security-deps.yml@2026-02-19
    with:
      language: "javascript"
      enable-license-check: true

  secret-detection:
    name: Secret Detection
    uses: sbaerlocher/.github/.github/workflows/security-secrets.yml@2026-02-19
